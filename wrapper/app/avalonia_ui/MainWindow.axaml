<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
        x:Class="avalonia_ui.MainWindow"
        Title="WhisperLiveKit Wrapper">
    <Grid RowDefinitions="Auto,*,Auto">
        <!-- Header -->
        <Grid Grid.Row="0" Margin="10" ColumnDefinitions="* Auto">
            <TextBlock Text="WhisperLiveKit Wrapper" FontSize="20" FontWeight="Bold" VerticalAlignment="Center"/>
            <Button Content="License" Grid.Column="1" Click="OnShowLicense"/>
        </Grid>

        <!-- Content -->
        <Grid Grid.Row="1" Margin="10" ColumnDefinitions="2*,3*" ColumnSpacing="10">
            <!-- Left column -->
            <StackPanel Grid.Column="0" Spacing="8">
                <StackPanel>
                    <TextBlock Text="Server Settings" FontWeight="Bold" Margin="0,0,0,4"/>
                    <Border BorderThickness="1" BorderBrush="Gray" Padding="5">
                        <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto" RowSpacing="4" ColumnSpacing="6">
                            <CheckBox x:Name="AllowExternal" Content="Allow external connections (0.0.0.0)" Grid.ColumnSpan="2"/>
                            <TextBlock Text="Backend host" Grid.Row="1" VerticalAlignment="Center"/>
                            <TextBox x:Name="BackendHost" Grid.Row="1" Grid.Column="1"/>
                            <TextBlock Text="Backend port" Grid.Row="2" VerticalAlignment="Center"/>
                            <TextBox x:Name="BackendPort" Grid.Row="2" Grid.Column="1"/>
                            <TextBlock Text="API host" Grid.Row="3" VerticalAlignment="Center"/>
                            <TextBox x:Name="ApiHost" Grid.Row="3" Grid.Column="1"/>
                            <TextBlock Text="API port" Grid.Row="4" VerticalAlignment="Center"/>
                            <TextBox x:Name="ApiPort" Grid.Row="4" Grid.Column="1"/>
                            <CheckBox x:Name="AutoStart" Content="Auto-start API on launch" Grid.Row="5" Grid.ColumnSpan="2"/>
                            <TextBlock Text="Whisper model" Grid.Row="6" VerticalAlignment="Center"/>
                            <ComboBox x:Name="ModelCombo" Grid.Row="6" Grid.Column="1"/>
                            <CheckBox x:Name="UseVac" Content="Use voice activity controller (VAD)" Grid.Row="7" Grid.ColumnSpan="2"/>
                            <CheckBox x:Name="Diarization" Content="Enable diarization" Grid.Row="8" Grid.ColumnSpan="2"/>
                            <StackPanel Grid.Row="9" Grid.ColumnSpan="2" Orientation="Horizontal" Spacing="6">
                                <Button Content="Advanced settings" Click="OnAdvancedSettings"/>
                                <Button Content="VAD settings" Click="OnVadSettings"/>
                                <Button Content="Diarization settings" Click="OnDiarSettings"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </StackPanel>

                <StackPanel Margin="0,8,0,0">
                    <TextBlock Text="Endpoints" FontWeight="Bold" Margin="0,0,0,4"/>
                    <Border BorderThickness="1" BorderBrush="Gray" Padding="5">
                        <Grid ColumnDefinitions="Auto,*,Auto" RowDefinitions="Auto,Auto,Auto" RowSpacing="4" ColumnSpacing="6">
                            <TextBlock Text="Backend Web UI" Grid.Row="0" VerticalAlignment="Center"/>
                            <TextBox x:Name="WebEndpoint" Grid.Row="0" Grid.Column="1" IsReadOnly="True"/>
                            <Button x:Name="OpenWebButton" Content="Open Web GUI" Grid.Row="0" Grid.Column="2" IsEnabled="False" Click="OnOpenWeb"/>
                            <TextBlock Text="Streaming WebSocket /asr" Grid.Row="1" VerticalAlignment="Center"/>
                            <TextBox x:Name="WsEndpoint" Grid.Row="1" Grid.Column="1" IsReadOnly="True"/>
                            <Button Content="Copy" Grid.Row="1" Grid.Column="2" Click="OnCopyWs"/>
                            <TextBlock Text="File transcription API (/v1/audio/transcriptions)" Grid.Row="2" VerticalAlignment="Center"/>
                            <TextBox x:Name="ApiEndpoint" Grid.Row="2" Grid.Column="1" IsReadOnly="True"/>
                            <Button Content="Copy" Grid.Row="2" Grid.Column="2" Click="OnCopyApi"/>
                        </Grid>
                    </Border>
                </StackPanel>
            </StackPanel>

            <!-- Right column -->
            <StackPanel Grid.Column="1" Spacing="8">
                <Grid ColumnDefinitions="*,Auto,Auto" ColumnSpacing="6">
                    <StackPanel Orientation="Horizontal" Spacing="6">
                        <Button Content="Manage models" Click="OnManageModels"/>
                        <Button Content="Hugging Face Login" Click="OnLoginHf"/>
                    </StackPanel>
                    <Button x:Name="StartButton" Content="Start API" Grid.Column="1" Click="OnStartClick"/>
                    <Button x:Name="StopButton" Content="Stop API" Grid.Column="2" Click="OnStopClick" IsEnabled="False"/>
                </Grid>

                <StackPanel>
                    <TextBlock Text="Recorder" FontWeight="Bold" Margin="0,8,0,4"/>
                    <Border BorderThickness="1" BorderBrush="Gray" Padding="5">
                        <StackPanel Spacing="5">
                            <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto,Auto" ColumnSpacing="6" RowSpacing="4">
                                <Button x:Name="RecordButton" Grid.Row="0" Grid.Column="0" Content="Start Recording" Click="OnRecordClick"/>
                                <TextBlock x:Name="TimerText" Grid.Row="0" Grid.Column="1" VerticalAlignment="Center"/>
                                <ProgressBar x:Name="RecordLevel" Grid.Row="1" Grid.ColumnSpan="2" Minimum="0" Maximum="1" Height="16"/>
                                <TextBox x:Name="TranscriptBox" Grid.Row="2" Grid.ColumnSpan="2" AcceptsReturn="True" IsReadOnly="True" Height="120"/>
                            </Grid>
                            <CheckBox x:Name="SaveEnabled" Content="Save transcript to file"/>
                            <StackPanel Orientation="Horizontal" Spacing="4">
                                <TextBox x:Name="SavePath" Width="200"/>
                                <Button Content="Browse" Click="OnBrowseSave"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </StackPanel>
        </Grid>

        <!-- Status bar -->
        <Grid Grid.Row="2" Margin="10" ColumnDefinitions="Auto,*" ColumnSpacing="6">
            <TextBlock x:Name="StatusText" Text="stopped" VerticalAlignment="Center"/>
            <ProgressBar x:Name="StatusProgress" Grid.Column="1" Height="16"/>
        </Grid>
    </Grid>
</Window>
